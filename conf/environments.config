# Environment-specific configurations for the genome annotation pipeline

// Windows-specific configuration
profiles {
    windows_local {
        process.executor = 'local'
        process.shell = ['powershell', '-Command']
        singularity.enabled = false
        docker.enabled = true
        docker.runOptions = '-u 0:0'
        
        process {
            withName: CLEAN_HEADERS {
                cpus = 2
                memory = "8.GB"
            }
            
            withName: REPEATMODELER {
                cpus = 4
                memory = "16.GB"
                time = "24.h"
            }
            
            withName: REPEATMASKER {
                cpus = 4
                memory = "8.GB"
                time = "12.h"
            }
              withName: BRAKER3 {
                cpus = 8
                memory = "32.GB"
                time = "48.h"
            }
            
            withName: BUSCO {
                cpus = 4
                memory = "8.GB"
                time = "2.h"
            }
        }
    }
    
    windows_wsl {
        process.executor = 'local'
        singularity.enabled = true
        singularity.autoMounts = true
        singularity.runOptions = '--bind /mnt'
        docker.enabled = false
        
        process {
            withName: CLEAN_HEADERS {
                cpus = 2
                memory = "8.GB"
            }
            
            withName: REPEATMODELER {
                cpus = 8
                memory = "32.GB"
                time = "48.h"
            }
            
            withName: REPEATMASKER {
                cpus = 4
                memory = "16.GB"
                time = "24.h"
            }
              withName: BRAKER3 {
                cpus = 8
                memory = "32.GB"
                time = "72.h"
            }
            
            withName: BUSCO {
                cpus = 4
                memory = "8.GB"
                time = "2.h"
            }
        }
    }
    
    laptop {
        // Configuration for laptop/desktop with limited resources
        process.executor = 'local'
        
        process {
            withName: CLEAN_HEADERS {
                cpus = 1
                memory = "4.GB"
                time = "2.h"
            }
            
            withName: REPEATMODELER {
                cpus = 2
                memory = "8.GB"
                time = "48.h"
            }
            
            withName: REPEATMASKER {
                cpus = 2
                memory = "4.GB"
                time = "12.h"
            }
              withName: BRAKER3 {
                cpus = 4
                memory = "16.GB"
                time = "72.h"
            }
            
            withName: BUSCO {
                cpus = 2
                memory = "4.GB"
                time = "4.h"
            }
        }
    }
    
    workstation {
        // Configuration for high-end workstation
        process.executor = 'local'
        
        process {
            withName: CLEAN_HEADERS {
                cpus = 4
                memory = "16.GB"
                time = "1.h"
            }
            
            withName: REPEATMODELER {
                cpus = 16
                memory = "64.GB"
                time = "24.h"
            }
            
            withName: REPEATMASKER {
                cpus = 8
                memory = "32.GB"
                time = "12.h"
            }
              withName: BRAKER3 {
                cpus = 32
                memory = "128.GB"
                time = "48.h"
            }
            
            withName: BUSCO {
                cpus = 16
                memory = "32.GB"
                time = "2.h"
            }
        }
    }
}

// Global settings for Windows environments
if (System.getProperty('os.name').toLowerCase().contains('windows')) {
    singularity.enabled = false
    docker.enabled = true
    docker.runOptions = '-u 0:0'
}
